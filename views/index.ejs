<!DOCTYPE html>
<html>

<head>
    <title>Crypto Price</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div class="page">

        <main class="container">
            <h1>Crypto Price Checker</h1>

            <form action="/price" method="get">
                <input name="symbol" placeholder="BTC, ETH, SOL" required />
                <button>Check</button>
            </form>

            <% if (data) { %>
                <div class="card">
                    <img src="<%= data.logo %>" alt="logo" />
                    <h2>
                        <%= data.name %> (<%= data.symbol %>)
                    </h2>

                    <p class="price">$<%= data.price %>
                    </p>

                    <p class="change <%= data.change >= 0 ? 'up' : 'down' %>">
                        24h: <%= data.change.toFixed(2) %>%
                    </p>

                    <iframe
                        src="https://s.tradingview.com/widgetembed/?symbol=<%= data.tvSymbol %>&interval=15&theme=dark"
                        width="100%" height="400" frameborder="0">
                    </iframe>
                </div>
                <% } %>

                    <% if (error) { %>
                        <p class="error">
                            <%= error %>
                        </p>
                        <% } %>
        </main>

        <!-- FOOTER -->
        <footer class="footer">
            <p>Â© <%= new Date().getFullYear() %> Purefier</p>
        </footer>

    </div>

    <!-- 5 min auto refresh -->
    <script>
        setTimeout(() => location.reload(), 300000);
    </script>
</body>

</html>